---
import { getContactsData, getPageData } from '@database/request';
import Icon from '../../atoms/Icon/Icon.astro';
import './ContactDisplay.scss';

const { data } = await getPageData('contact');
const { data: contacts } = await getContactsData();
---

<div class='contact-content container--padded'>
  <h3 class='contact-content__title'>{data?.title ?? 'Get in touch'}</h3>
  <p class='contact-content__subtitle'>
    {
      data?.text ??
        "Have a project in mind or want to collaborate? I'd love to hear from you!"
    }
  </p>

  <div class='contact-content__social-section'>
    <div class='contact-content__container'>
      {
        contacts?.map(item => {
          return (
            <a
              href={item?.href}
              target='_blank'
              rel='noopener noreferrer'
              class='contact-content__link'
              type={item?.name}
            >
              <Icon modifier={item?.name} className='contact-content__icon' />
              <span>{item?.title}</span>
            </a>
          );
        })
      }
    </div>
  </div>
</div>

<script>
  import { showToast } from '../../providers/ToastProvider';

  const emailBtn = document.querySelector("[type='email']");
  emailBtn?.addEventListener('click', e => {
    e.preventDefault();
    const target = e.currentTarget as HTMLAnchorElement;
    const href = target.getAttribute('href');
    navigator.clipboard.writeText(href?.replace('mailto:', '') || '');
    showToast('Email copied to clipboard!');
  });
</script>
